{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2014/12/17/a-cause-in-poor-performance/","webpackCompilationHash":"7a2b55a2d04ca1da1bf3","result":{"data":{"site":{"siteMetadata":{"title":"Mitchell Simoens Blog","author":"Mitchell Simoens"}},"markdownRemark":{"id":"97cdc8a6-680a-53d6-9649-81973dbd665c","excerpt":"Over the years of working with Ext JS and Sencha Touch, I’ve gotten to see lots of code both from projects I’ve worked on and for the many code reviews I’ve…","html":"<p>Over the years of working with Ext JS and Sencha Touch, I’ve gotten to see lots of code both from projects I’ve worked on and for the many code reviews I’ve done. One common thing I always see, and I’m not exaggerating when I say always, is something that can degrade performance quickly both on the DOM and JavaScript execution level. It’s called “overnesting” and it’s an epidemic.</p>\n<h4>What is “overnesting”?</h4>\n<p>Ext JS and Sencha Touch work with Component and Layout systems where you layout your UI by instantiating Components and position/size them using a layout. Overnesting is when you nest a component within a container when that component does not need to be nested. When I say “component”, I mean any component not just <code class=\"language-text\">Ext.Component</code>; likewise, “container” doesn’t just mean <code class=\"language-text\">Ext.container.Container</code> it also means for any subclass like <code class=\"language-text\">Ext.form.Panel</code> or <code class=\"language-text\">Ext.grid.Panel</code>.</p>\n<h4>Affect of “overnesting”</h4>\n<p>The side affects of overnesting can include:</p>\n<ul>\n<li>Extra DOM nodes</li>\n<li>Extra JavaScript execution</li>\n<li>Extra layout runs by the browser and/or the framework</li>\n<li>Layout issues, components not laid out properly on all platforms\n- IE may display differently than Chrome</li>\n</ul>\n<p>Any of these are bad and will happen if you have overnesting in your application.</p>\n<h4>Example</h4>\n<p>Let’s look at a sample of overnesting:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Ext.create(&#39;Ext.tab.Panel&#39;, {\n    items : [\n        {\n            xtype  : &#39;panel&#39;,\n            title  : &#39;Users&#39;,\n            layout : &#39;fit&#39;,\n            tbar   : [\n                { text : &#39;Create User&#39; }\n            ],\n            items  : [\n                {\n                    xtype   : &#39;gridpanel&#39;,\n                    store   : &#39;Users&#39;,\n                    columns : [\n                        {\n                            text      : &#39;Name&#39;,\n                            dataIndex : &#39;name&#39;,\n                            flex      : 1\n                        }\n                    ]\n                }\n            ]\n        }\n    ]\n});</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In this example, we create a tab panel with a single tab that is a panel. The panel has a top docked toolbar with a Create User button and also a grid that is laid out using fit layout. While this will work and look as you would expect, it’s overnesting. The panel is a layer that is not needed just to have a top docked toolbar, the grid can have a top docked toolbar and will look exactly the same:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Ext.create(&#39;Ext.tab.Panel&#39;, {\n    items : [\n        {\n            xtype   : &#39;gridpanel&#39;,\n            store   : &#39;Users&#39;,\n            tbar    : [\n                { text : &#39;Create User&#39; }\n            ],\n            columns : [\n                {\n                    text      : &#39;Name&#39;,\n                    dataIndex : &#39;name&#39;,\n                    flex      : 1\n                }\n            ]\n        }\n    ]\n});</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h4>Spotting “overnesting”</h4>\n<p>That was a very simple example, applications are going to be much more complex. The first tip I could give is you need to be aware of what your code is doing. A browser does a very good job at showing the DOM structure, it’s a tree of nodes. Your application’s UI is also a tree. The overnesting example could look like this in a tree format:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">--Ext.tab.Panel\n----Ext.panel.Panel\n------Ext.grid.Panel</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>If you start to visualize your layout as a tree, you’ll start to realize how things are laid out and can then spot possible overnesting.</p>\n<p>Another tip would be to use tools or scripts. For example, <a href=\"https://chrome.google.com/webstore/detail/app-inspector-for-sencha/pbeapidedgdpniokbedbfbaacglkceae\">Sencha AppInspector</a> can display your components in an actual <code class=\"language-text\">Ext.tree.Panel</code> and give you a bit more information on each component that will help you debug your application. I personally prefer having intimate knowledge over the projects I work on but AppInspector can aid your understanding.</p>\n<h4>Conclusion</h4>\n<p>Overnesting can cause poor performance and all sorts of issues in your application. Even if overnesting isn’t a cause of a bug in an application I’m looking at, it’s still something that has to be addressed. To me, it’s not optional; overnesting must be solved.</p>","fields":{"slug":"/2014/12/17/a-cause-in-poor-performance/"},"frontmatter":{"title":"A cause in poor performance","date":"December 17, 2014"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2014/12/17/a-cause-in-poor-performance/","previous":{"fields":{"slug":"/2014/12/17/wordpress-is-slow-ghost-is-better/"},"frontmatter":{"title":"Wordpress is slow, Ghost is better?"}},"next":{"fields":{"slug":"/2014/12/18/store-listeners/"},"frontmatter":{"title":"Store Listeners"}}}}}