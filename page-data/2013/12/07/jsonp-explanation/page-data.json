{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/2013/12/07/jsonp-explanation/","webpackCompilationHash":"7a2b55a2d04ca1da1bf3","result":{"data":{"site":{"siteMetadata":{"title":"Mitchell Simoens Blog","author":"Mitchell Simoens"}},"markdownRemark":{"id":"8d3fc809-a8c6-578c-ac72-1a3f0351ae99","excerpt":"Talking to a lot of people, I get the sense that there are quite a lot of people who don’t actually understand what JsonP is and how it works. In this blog post…","html":"<p>Talking to a lot of people, I get the sense that there are quite a lot of people who don’t actually understand what JsonP is and how it works. In this blog post, I hope to provide some explanation behind JsonP as it’s truly a very simple concept.</p>\n<h2>Why would someone want to use JsonP?</h2>\n<p>JsonP is a means of transporting data from a client to a server across origins (different domains or ports). You can accomplish the same with an Xhr request and some headers from your server (I enjoy this site for help with CORS: <a href=\"http://enable-cors.org/\" target=\"_blank\">enable-cors.org</a>) but I’ve talked to many system admins and they don’t like adding the headers. With JsonP, you do not need to have any additional server setup, you can handle it in your endpoint (using PHP, Java or whatever language you are using). I personally like enabling CORS on my server as you can specify what origins to accept cross origin requests from where JsonP doesn’t have this security. Well, that’s not entirely true, your server side language can check where the request came from. And to be 100% honest, you don’t need a server admin to add a header to the server as a server side language can usually return a header (like the header() function in PHP) but I find that a bit awkward.</p>\n<h2>In a nut shell, what is JsonP?</h2>\n<p>Like I said in the second sentence of this blog, JsonP is truly a very simple concept. It has 2 parts, a Javascript function used as a callback that you define on the client and a &#x3C;script&#x3C; element you have in your HTML page. The &#x3C;script> element will handle the transport of data and the callback function handles the data when it has been loaded. That’s it. In fact here is an example:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;html&gt;\n    &lt;head&gt;\n        &lt;script type=&quot;text/javascript&quot;&gt;\n            window.MyCallback = function(data) {\n                //handle the data returned here\n            };\n        &lt;/script&gt;\n    \t&lt;script type=&quot;text/javascript&quot; src=&quot;http://mydomain.com:8080/data.php?callback=MyCallback&quot;&gt;&lt;/script&gt;\n    &lt;/head&gt;\n    &lt;body&gt;&lt;/body&gt;\n&lt;/html&gt;</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Like I said, we have a Javascript function that is used as a callback, I’ve named mine MyCallback and you have a &#x3C;script> element that does the actual loading. Pretty simple right? There is no smoke and mirrors, there is no Xhr request going on that you need to set up.</p>\n<h2>So this is how Ext JS’ Ext.data.JsonP works?</h2>\n<p>It’s exactly how Ext.data.JsonP works. If you execute this code in Ext JS:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">Ext.data.JsonP.request({\n    url : &#39;http://mydomain.com:8080/data.php&#39;\n});</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>All it’s doing is creating the callback function (which it will append to the url you provided so no need to worry about that) and inserting that &#x3C;script> into the &#x3C;head> of your HTML document. It does other things like enables a timeout, keeps track of the requests, executes a success/failure function you can provide to the request method and cleans up the &#x3C;script> after loading.</p>\n<h2>How do I handle this on the server?</h2>\n<p>Like I said, this request no server setup, it’s all handled in your server side language of choice. The request will have a callback request parameter and it’s value should wrap your “Json” data which actually will execute the Javascript callback function that is supposed to be created in the client app. Let’s use my first code that we used when describing JsonP in a nutshell. It’s sending the callback parameter with a value of MyCallback so our “Json” needs to be wrapped in MyCallback so that we execute the MyCallback function. Here is an example of the response:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">MyCallback({\n    &quot;foo&quot;: &quot;bar&quot;\n});</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Looks exactly like Javascript doesn’t it? That’s because it is Javascript. Remember, the &#x3C;script> does the loading which will expect Javascript. It’s just like if you were loading a somefile.js with a &#x3C;script> only it’s Javascript returned from a server side language instead of some file on your server.</p>\n<p>My server side language of choice is PHP. Here is a sample PHP script that would support JsonP:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">&lt;?php\n\n$isJsonP = isset($_REQUEST[&#39;callback&#39;]);\n$data    = array(&#39;foo&#39; =&gt; &#39;bar&#39;);\n\nif ($isJsonP) {\n    echo $_REQUEST[&#39;callback&#39;] . &#39;(&#39;;\n}\n\necho json_encode($data);\n\nif ($isJsonP) {\n    echo &#39;);&#39;;\n}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>In this code, if there is a callback parameter the $isJsonP variable will be true which will wrap the json that is echoed out with the callback function and the needed parentheses. This will echo out the example JsonP response from above.</p>\n<h2>Let’s summarize this up</h2>\n<p>JsonP is a means of transporting data across different origins. All JsonP is is a Javascript function and a &#x3C;script> element which makes JsonP compliant with any browser that can load Javascript files with absolutely zero setup.</p>","fields":{"slug":"/2013/12/07/jsonp-explanation/"},"frontmatter":{"title":"JsonP Explanation","date":"December 07, 2013"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2013/12/07/jsonp-explanation/","previous":{"fields":{"slug":"/2013/03/10/client-side-associations/"},"frontmatter":{"title":"Client side associations"}},"next":{"fields":{"slug":"/2014/03/19/tiny-performance-boost-in-data-drive-ext-jssencha-touch-apps/"},"frontmatter":{"title":"Tiny Performance Boost in Data Drive Ext JS/Sencha Touch apps"}}}}}