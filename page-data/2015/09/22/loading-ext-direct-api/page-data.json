{"componentChunkName":"component---src-templates-blog-post-js","path":"/2015/09/22/loading-ext-direct-api/","webpackCompilationHash":"02bb8f8c0b363ef91a23","result":{"data":{"site":{"siteMetadata":{"title":"Mitchell Simoens Blog","author":"Mitchell Simoens"}},"markdownRemark":{"id":"26893ad4-32d3-5823-b425-c806bef1de4f","excerpt":"Personally, I use a technology called Ext.Direct for my projects. Ext.Direct is platform and language agnostic remote procedure call protocol. I’m not going to…","html":"<p>Personally, I use a technology called Ext.Direct for my projects. Ext.Direct is platform and language agnostic remote procedure call protocol. I’m not going to go into the features and benefits of using Ext.Direct in this post, I’ll save it for a different post but you can check out the <a href=\"http://docs.sencha.com/extjs/latest/direct/specification.html\">spec</a> we released.</p>\n<h3>Bad Ways</h3>\n<p>Lately, I’ve seen a few methods people are using to load the api descriptor and I’d like to show them and discuss why they are a bad idea and then of course show the proper way. First means of loading the api I recently saw is this:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Ext.define(&#39;MyApp.DirectAPI&#39;, {\n    requires: [&#39;Ext.direct.*&#39;, &#39;Ext.Ajax&#39;]\n}, function() {\n    Ext.Ajax.request({\n        url: &quot;/DirectApi&quot;,\n        async: false,\n        success: function(xhr) {\n            Ext.globalEval(xhr.responseText);\n        },\n        failure: function(xhr) {\n            throw &quot;Direct API load failed with error code &quot; + xhr.status + &quot;: &quot; + xhr.statusText;\n        }\n    });\n    Ext.direct.Manager.addProvider(Ext.app.REMOTING_API);\n});</code></pre></div>\n<p>What this is doing is if the application requires <code class=\"language-text\">MyApp.DirectAPI</code> it will then do a synchronous ajax call, eval the response and then add the provider.</p>\n<p>Another means I saw is:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Ext.define(&#39;MyApp.DirectAPI&#39;, {\n    requires: [&#39;Ext.direct.*&#39;]\n}, function() {\n    Ext.Loader.loadScriptsSync(&#39;api.php&#39;);\n    /*\n    Add provider. Name must match settings on serverside\n    */\n    Ext.direct.Manager.addProvider(Ext.app.REMOTING_API);\n});</code></pre></div>\n<p>This is basically the same thing as the first code, just uses <code class=\"language-text\">Ext.Loader.loadScriptsSync</code> instead of <code class=\"language-text\">Ext.Ajax.request</code>. The only difference is the <code class=\"language-text\">loadScriptsSync</code> does the eval for you, both use <code class=\"language-text\">XMLHttpRequest</code>.</p>\n<h3>The Why</h3>\n<p>So these techniques work but why are they bad? The main issue in both is the use of a synchronous call. Let’s look at this from a user standpoint. The user has to wait for the application to load (Ext JS apps are normally larger), then the browser locks up for a period of time and then the application renders. What would you do if every time you visit an app you had a period where it locks up the entire browser? Honestly, I wouldn’t use it or if I had to I’d complain about it. Networks fail, servers can be complex and slow. If the call to load the Ext.Direct api took 10 seconds, you’d have 10 seconds where the user is sitting looking at the screen with a browser that cannot do anything. I’ve forced closed apps for that before. In fact, at one client an async request took over a minute to complete and I fought to have them fix that, their solution was for me to raise the timeout. People need to look at the issue and see the proper way to fix issues, not just what’s fast and easy.</p>\n<h3>The Proper Way</h3>\n<p>If you are using <a href=\"https://www.sencha.com/products/extjs/#sencha-cmd\">Sencha Cmd</a> (which I would highly recommend), instead of the code ways above all you have to do is add the script to the <code class=\"language-text\">app.json</code>’s <code class=\"language-text\">js</code> array:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&quot;js&quot;: [\n    {\n        &quot;path&quot;: &quot;app.js&quot;,\n        &quot;bundle&quot;: true\n    },\n    {\n        &quot;path&quot;: &quot;/direct/api&quot;,\n        &quot;remote&quot;: true\n    }\n]</code></pre></div>\n<p>Now, after you run a <code class=\"language-text\">sencha app watch</code> or <code class=\"language-text\">sencha app build</code>, Ext JS will automatically create a <code class=\"language-text\">&lt;script&gt;</code> tag to load the direct api and defer the application’s <code class=\"language-text\">launch</code> method from executing until it has loaded. Then in the <code class=\"language-text\">launch</code> method you can then use the <code class=\"language-text\">Ext.direct.Manager.addProvider</code>.</p>\n<p>If you’re not using Sencha Cmd, then all you have to do is add a <code class=\"language-text\">&lt;script&gt;</code> to your index.html and your application’s <code class=\"language-text\">launch</code> method or <code class=\"language-text\">Ext.onReady</code> will defer till it loads:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;script type=&quot;text/javascript&quot; charset=&quot;UTF-8&quot; src=&quot;/direct/api&quot;&gt;&lt;/script&gt;</code></pre></div>\n<p>Without doing anything on the server, the application will still wait for the direct api to load so you still will have that issue to contend with but the browser will not be locked up. If the person wants to close the browser for whatever reason or open a new tab to do something else they can. So the difference is if the browser will be locked up or not, I’d choose not to lock the user’s browser up. Even if the load takes &#x3C; 1 second, since there is a way not to do it I wouldn’t.</p>","fields":{"slug":"/2015/09/22/loading-ext-direct-api/"},"frontmatter":{"title":"Loading Ext.Direct api","date":"September 22, 2015"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2015/09/22/loading-ext-direct-api/","previous":{"fields":{"slug":"/2015/09/17/sftp-server-in-node-js/"},"frontmatter":{"title":"SFTP server in Node.js"}},"next":{"fields":{"slug":"/2015/12/03/custom-two-way-binding/"},"frontmatter":{"title":"Custom Two Way Binding!"}}}}}